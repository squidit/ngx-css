<div class="wrapper-all-inside-input {{ customClass }}">
  @if (label?.length || tooltipMessage || labelTemplate) {
    <label
      class="display-flex"
      [ngClass]="{
        readonly: readonly,
      }"
      [for]="id"
    >
      @if (label && !labelTemplate) {
        <div [ngStyle]="{ color: labelColor }" [innerHtml]="label | universalSafe"></div>
      }
      @if (labelTemplate) {
        <div>
          <ng-container *ngTemplateOutlet="labelTemplate"></ng-container>
        </div>
      }
      @if (tooltipMessage) {
        <sq-tooltip
          class="ml-1"
          [message]="tooltipMessage"
          [placement]="tooltipPlacement"
          [color]="tooltipColor"
          [icon]="tooltipIcon"
        ></sq-tooltip>
      }
    </label>
  }
  <div
    class="p-0 wrapper-input wrapper-input-squid"
    [ngStyle]="{ 'border-color': borderColor }"
    [ngClass]="{
      error: (externalError && externalError !== '') || (error && error !== ''),
      readonly: readonly,
    }"
  >
    @if (leftLabel) {
      <span class="input-group-text m-0">
        <ng-container *ngTemplateOutlet="leftLabel"></ng-container>
      </span>
    }
    <select
      class="select"
      [ngClass]="{
        disabled: disabled,
        readonly: readonly,
      }"
      [ngStyle]="{
        'background-color': backgroundColor,
        'border-color': borderColor,
      }"
      [id]="id"
      [name]="name"
      [required]="required"
      [disabled]="disabled || readonly || loading"
      (blur)="validate(true)"
      [value]="value"
      (change)="change(select?.value)"
      (focus)="emitFocus.emit()"
      #select
    >
      @if (placeholder) {
        <option value="" [selected]="!value" disabled>{{ placeholder }}</option>
      }
      @for (group of optionsWithGroups; track group) {
        <optgroup [label]="group?.label">
          @for (option of group?.options; track option) {
            <option [value]="option?.value" [selected]="value === option?.value" [disabled]="!!option?.disabled">
              {{ option?.label }}
            </option>
          }
        </optgroup>
      }
      @for (option of options; track option) {
        <option [value]="option?.value" [selected]="value === option?.value" [disabled]="!!option?.disabled">
          {{ option?.label }}
        </option>
      }
    </select>
    @if (rightLabel) {
      <span class="input-group-text m-0">
        <ng-container *ngTemplateOutlet="rightLabel"></ng-container>
      </span>
    }
  </div>
  @if (externalIcon) {
    <span class="icon icon-external" [innerHtml]="externalIcon || '' | universalSafe"></span>
  }
  @if (errorSpan) {
    <div class="box-validation box-invalid show">
      @if (externalError || error) {
        <i class="fa-solid fa-triangle-exclamation"></i>
      }
      {{ externalError ? externalError : '' }}
      {{ error && !externalError ? error : '' }}
    </div>
  }
</div>
