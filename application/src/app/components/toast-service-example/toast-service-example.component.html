<div class="toast-service-example">
  <h1>SqToastService - Exemplos</h1>
  <p class="description">
    Novo sistema de toasts com suporte a Observable, data-test attributes e testabilidade completa.
  </p>

  <!-- Configura√ß√£o Global -->
  <section class="config-section">
    <h2>Configura√ß√£o</h2>
    <div class="config-grid">
      <div class="config-item">
        <label for="position">Posi√ß√£o:</label>
        <select id="position" [(ngModel)]="selectedPosition">
          @for (pos of positions; track pos) {
            <option [value]="pos">{{ pos }}</option>
          }
        </select>
      </div>
      <div class="config-item">
        <label for="duration">Dura√ß√£o (ms):</label>
        <input id="duration" type="number" [(ngModel)]="selectedDuration" min="0" step="1000" />
      </div>
      <div class="config-item">
        <label for="message">Mensagem:</label>
        <input id="message" type="text" [(ngModel)]="customMessage" />
      </div>
    </div>
  </section>

  <!-- Status -->
  <section class="status-section">
    <div class="status-grid">
      <div class="status-item">
        <strong>Toasts Ativos:</strong> {{ getActiveCount() }}
      </div>
      <div class="status-item">
        <strong>√öltimo Motivo de Fechamento:</strong>
        <code>{{ lastDismissReason || 'N/A' }}</code>
      </div>
    </div>
  </section>

  <div class="examples-grid">
    <!-- NOVO: SqToastService -->
    <section class="example-section new-service">
      <div class="section-header">
        <h2>‚úÖ NOVO: SqToastService</h2>
        <span class="badge badge-success">Recomendado</span>
      </div>
      <p class="section-description">
        Observable-based, test√°vel, com data-test attributes
      </p>

      <h3>Tipos B√°sicos</h3>
      <div class="buttons-group">
        <button class="button background-green" (click)="showSuccess()">Success</button>
        <button class="button background-red" (click)="showError()">Error</button>
        <button class="button background-yellow text-dark" (click)="showWarning()">Warning</button>
        <button class="button background-blue" (click)="showInfo()">Info</button>
        <button class="button background-secondary" (click)="showDefault()">Default</button>
      </div>

      <h3>Mensagem Customizada</h3>
      <div class="buttons-group">
        <button class="button background-primary" (click)="showCustomMessage()">Mostrar Mensagem</button>
      </div>

      <h3>Recursos Avan√ßados</h3>
      <div class="buttons-group">
        <button class="button background-primary" (click)="showWithAction()">
          Com A√ß√£o (Desfazer)
        </button>
        <button class="button background-primary" (click)="showPersistent()">
          Persistente (duration: 0)
        </button>
        <button class="button background-primary" (click)="showWithObservable()">
          Com Observable
        </button>
      </div>

      <h3>Customiza√ß√µes</h3>
      <div class="buttons-group">
        <button class="button background-secondary" (click)="showCloseable()">Com Bot√£o Fechar</button>
        <button class="button background-secondary" (click)="showDismissOnClick()">Clique para Fechar</button>
        <button class="button background-secondary" (click)="showNoIcon()">Sem √çcone</button>
        <button class="button background-secondary" (click)="showCustomIcon()">√çcone Customizado</button>
      </div>

      <h3>M√∫ltiplos Toasts</h3>
      <div class="buttons-group">
        <button class="button background-primary" (click)="showMultiple()">Mostrar 3 Toasts</button>
        <button class="button background-secondary" (click)="dismissActive()">Fechar Persistente</button>
        <button class="button background-red" (click)="dismissAll()">Fechar Todos</button>
      </div>
    </section>

    <!-- ANTIGO: ToastHelper -->
    <section class="example-section old-service">
      <div class="section-header">
        <h2>‚ö†Ô∏è ANTIGO: ToastHelper</h2>
        <span class="badge badge-warning">Deprecated</span>
      </div>
      <p class="section-description">
        Depende de window.Toast global, n√£o test√°vel
      </p>

      <h3>Tipos B√°sicos</h3>
      <div class="buttons-group">
        <button class="button background-green" (click)="legacySuccess()">Success</button>
        <button class="button background-red" (click)="legacyError()">Error</button>
        <button class="button background-yellow text-dark" (click)="legacyWarning()">Warning</button>
        <button class="button background-blue" (click)="legacyInfo()">Info</button>
      </div>

      <div class="deprecation-warning">
        <h4>‚ö†Ô∏è Problemas do ToastHelper:</h4>
        <ul>
          <li>‚ùå Depende de <code>window.Toast</code> global</li>
          <li>‚ùå N√£o funciona em SSR</li>
          <li>‚ùå Imposs√≠vel mockar em testes unit√°rios</li>
          <li>‚ùå Sem <code>data-test</code> attributes</li>
          <li>‚ùå Sem Observable para lifecycle</li>
          <li>‚ùå Sem controle program√°tico (dismiss)</li>
        </ul>
      </div>
    </section>
  </div>

  <!-- Comparativo -->
  <section class="comparison-section">
    <h2>üìä Comparativo</h2>
    <table class="comparison-table">
      <thead>
        <tr>
          <th>Recurso</th>
          <th>ToastHelper (Antigo)</th>
          <th>SqToastService (Novo)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Inje√ß√£o de Depend√™ncia</td>
          <td class="bad">‚ö†Ô∏è Depende de window.Toast</td>
          <td class="good">‚úÖ 100% Angular</td>
        </tr>
        <tr>
          <td>Testabilidade</td>
          <td class="bad">‚ùå N√£o mock√°vel</td>
          <td class="good">‚úÖ spyOn() funciona</td>
        </tr>
        <tr>
          <td>Data-test Attributes</td>
          <td class="bad">‚ùå N√£o suporta</td>
          <td class="good">‚úÖ Em cada elemento</td>
        </tr>
        <tr>
          <td>Observable Lifecycle</td>
          <td class="bad">‚ùå N√£o tem</td>
          <td class="good">‚úÖ afterDismissed()</td>
        </tr>
        <tr>
          <td>Dismiss Program√°tico</td>
          <td class="bad">‚ùå N√£o suporta</td>
          <td class="good">‚úÖ ref.dismiss()</td>
        </tr>
        <tr>
          <td>A√ß√µes (Desfazer)</td>
          <td class="bad">‚ùå N√£o suporta</td>
          <td class="good">‚úÖ action.callback</td>
        </tr>
        <tr>
          <td>SSR Compat√≠vel</td>
          <td class="bad">‚ùå N√£o funciona</td>
          <td class="good">‚úÖ Funciona</td>
        </tr>
        <tr>
          <td>Pause on Hover</td>
          <td class="bad">‚ùå N√£o tem</td>
          <td class="good">‚úÖ Configur√°vel</td>
        </tr>
        <tr>
          <td>M√∫ltiplas Posi√ß√µes</td>
          <td class="bad">‚ö†Ô∏è Limitado</td>
          <td class="good">‚úÖ 6 posi√ß√µes</td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- Hist√≥rico -->
  @if (toastHistory.length > 0) {
    <section class="history-section">
      <div class="history-header">
        <h2>üìú Hist√≥rico de Toasts</h2>
        <button class="button background-secondary button-sm" (click)="clearHistory()">Limpar</button>
      </div>
      <div class="history-list">
        @for (item of toastHistory; track item.timestamp) {
          <div class="history-item" [class]="'type-' + item.type">
            <span class="history-type">{{ item.type }}</span>
            <span class="history-message">{{ item.message }}</span>
            <span class="history-time">{{ item.timestamp | date: 'HH:mm:ss' }}</span>
          </div>
        }
      </div>
    </section>
  }

  <!-- C√≥digo de Exemplo -->
  <section class="code-section">
    <h2>üíª Exemplo de C√≥digo</h2>

    <h3>Uso B√°sico</h3>
    <pre><code>import &#123; SqToastService &#125; from '&#64;squidit/ngx-css';

&#64;Component(&#123;...&#125;)
export class MyComponent &#123;
  private toastService = inject(SqToastService);

  showSuccess() &#123;
    this.toastService.success('Opera√ß√£o realizada!');
  &#125;
&#125;</code></pre>

    <h3>Com A√ß√£o (Desfazer)</h3>
    <pre><code>this.toastService.success('Item removido', &#123;
  duration: 8000,
  action: &#123;
    label: 'Desfazer',
    callback: () => this.undoDelete()
  &#125;
&#125;);</code></pre>

    <h3>Com Observable</h3>
    <pre><code>this.toastService.warning('Confirma?', &#123; duration: 0 &#125;)
  .afterDismissed()
  .subscribe(reason => &#123;
    // reason: 'timeout' | 'action' | 'manual' | 'swipe'
    console.log('Fechou por:', reason);
  &#125;);</code></pre>

    <h3>Teste Unit√°rio</h3>
    <pre><code>it('deve mostrar toast de sucesso', () => &#123;
  const toastSpy = spyOn(toastService, 'success').and.callThrough();

  component.saveData();

  expect(toastSpy).toHaveBeenCalledWith('Dados salvos!');
&#125;);</code></pre>

    <h3>Teste E2E (Cypress)</h3>
    <pre><code>cy.get('[data-test="save-button"]').click();
cy.get('[data-test="sq-toast-1"]').should('contain', 'Dados salvos!');
cy.get('[data-test="sq-toast-1-close"]').click();</code></pre>
  </section>
</div>

